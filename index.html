<!DOCTYPE html>
<html>
  <head>
    <title>Application of Computed Tomography Data   to Cancer Risk Prediction</title>
    <meta charset="utf-8">
    <meta name="author" content="Martin Skarzynski" />
    <meta name="date" content="2019-06-04" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Application of Computed Tomography Data <br/> to Cancer Risk Prediction
### Martin Skarzynski
### 2019-06-04

---


&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 35px;
    padding: 1em 4em 1em 4em;
}
.large { font-size: 130% }
.small { font-size: 55% }
.remark-slide-number {
  display: none;
}
figure {
  text-align: center;
  font-size: large;
}

.remark-code, .remark-inline-code { font-family: 'Source Code Pro', 'Lucida Console', Monaco, monospace;
                                    font-size: 64%;
                                  }

&lt;/style&gt;



# Goal

- Contribute to cancer risk prediction methods

--

- Improve efficiency of cancer screening

--

  - Reduce harms

--

  - Maximize benefits

--

  - Decrease costs



---

# Lung cancer screening saves lives [(NLST, 2011)](https://doi.org/10.1056/NEJMoa1102873)

.center[
  &lt;a href="https://doi.org/10.1056/NEJMoa1102873"&gt;
    &lt;img src='images/nlst-mortality.png' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
  ]

---

# Lung cancer screening is inefficient &lt;a href="https://doi.org/10.1016/S2213-2600(19)30136-5"&gt;(IARC, 2018)&lt;/a&gt;

Of 1000 individuals scanned 3 times:

.center[
  &lt;a href="https://doi.org/10.1016/S2213-2600(19)30136-5"&gt;
    &lt;img src='images/iarc-infographic-normals.png' height='400'&gt;&lt;/img&gt;
  &lt;/a&gt;
  ]


---

# Lung cancer screening is inefficient &lt;a href="https://doi.org/10.1016/S2213-2600(19)30136-5"&gt;(IARC, 2018)&lt;/a&gt;

Of 1000 individuals scanned 3 times:

.center[
  &lt;a href="https://doi.org/10.1016/S2213-2600(19)30136-5"&gt;
    &lt;img src='images/iarc-infographic-positives.png' height='400'&gt;&lt;/img&gt;
  &lt;/a&gt;
  ]

---

# Lung cancer screening benefits &gt; harms &lt;a href="https://doi.org/10.1016/S2213-2600(19)30136-5"&gt;(IARC, 2018)&lt;/a&gt;

Of 1000 individuals scanned 3 times:

- Major complication from procedure: 1 in 2500 
  &lt;img src='images/two-fifths.gif' height='50'&gt;&lt;/img&gt;
- Death within 60 days of procedure: 1 in 5000 
  &lt;img src='images/one-fifth.gif' height='50'&gt;&lt;/img&gt;

---

# Targeted lung cancer screening [(Kovalchik, 2013)](https://www.nejm.org/doi/10.1056/NEJMoa1301851) 

.center[
  &lt;a href="https://www.nejm.org/doi/10.1056/NEJMoa1301851"&gt;
    &lt;img src='images/targeted-lung-cancer-screening.png' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
  ]

---

# Emphysema

.center[
  &lt;a href="https://doi.org/10.1093/jnci/djz041"&gt;
    &lt;img src='images/emphysema.png' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
]

---

# Emphysema is commonly caused by smoking [(ALA)](https://www.lung.org/lung-health-and-diseases/lung-disease-lookup/emphysema/)

.center[
  &lt;a href="https://doi.org/10.1093/jnci/djz041"&gt;
    &lt;img src='images/smoking.jpg' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
]


---
# Statistical Models
1. Bach Model
  - .small[Bach et al., (2003) Variations in lung cancer risk among smokers.JNCI 95: 470-478]
1. Prostate, Lung, Colorectal, and Ovarian Cancer Screening Trial Model 2012 (PLCOM2012)
  - .small[Tammemägi et al., (2013) Selection criteria for lung-cancer screening. NEJM 368:728-736]
1. Lung Cancer Risk Assessment Tool (LCRAT)
  - .small[Katki et al., (2016) Development and validation of risk models to select ever-smokers for CT lung cancer screening. JAMA 315:2300-2311]

---

| Covariate                         | Bach | PLCOm2012 | LCRAT |
|-----------------------------------|------|-----------|-------|
| Age                               | Yes  | Yes       | Yes   |
| Gender                            | Yes  | No        | Yes   |
| Race/ethnicity                    | No   | Yes       | Yes   |
| Education                         | No   | Yes       | Yes   |
| BMI                               | No   | Yes       | Yes   |
| Years/Age quit                    | Yes  | Yes       | Yes   |
| Years smoked                      | Yes  | Yes       | Yes   |
| Cigs per day                      | Yes  | Yes       | Yes   |
| Pack-years                        | No   | No        | Yes   |
| Lung disease                      | No   | Yes       | Yes   |
| Num. FDR w/ LC                    | No   | No        | Yes   |

---

# Likelihood ratio test [(lmtest::lrtest)](https://www.rdocumentation.org/packages/lmtest/versions/0.9-36/topics/lrtest)

```
lmtest::lrtest(neg_t0, neg_emph_t0)
```

```
Model 1: case ~ log1yrisk - 1
Model 2: case ~ log1yrisk + log1yrisk:emphysema - 1

  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   1 -370.74                         
2   2 -367.43  1 6.6249   0.010056 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```

---
# Deep learning versus visual scoring [(Humphries, 2018)](https://link.springer.com/chapter/10.1007/978-3-030-00946-5_32)

.center[
  &lt;a href="https://link.springer.com/chapter/10.1007/978-3-030-00946-5_32"&gt;
    &lt;img src='images/deeplearning.png' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
]


---
# Model design

.center[
  &lt;img src='images/emphnet1.png' height='450'&gt;&lt;/img&gt;
  ]

---
# Input


.center[
  &lt;img src='images/eight.gif' height='450'&gt;&lt;/img&gt;
  ]

---
# Convolution


.center[
  &lt;img src='images/convolution_schematic.gif' height='450'&gt;&lt;/img&gt;
  ]


---
# Batch normalization

1. Calculate the mean and variance of the layers input
  - mean: `\({\mu _{B}={\frac {1}{m}}\sum _{i=1}^{m}x_{i}}\)`
  - variance: `\({\sigma _{B}^{2}={\frac {1}{m}}\sum _{i=1}^{m}(x_{i}-\mu _{B})^{2}}\)`
2. Normalize the layer inputs using the previously calculated batch statistics `\({\large {\hat {x}}_{i}={\frac {x_{i}-\mu_{B}}{\sqrt {\sigma _{B}^{^{2}}+\epsilon }}}}\)`
3. Scale and shift in order to obtain the output of the layer `\(\large y_{i}=\gamma {\hat {x}}_{i}+\beta\)`



---
# Rectified Linear Unit (ReLU)

If x &lt; 0, 0

Else, x

`$$\huge f(x)=x^{+}=\max(0,x)$$`



---
# Max pooling

.center[
  &lt;img src='images/maxpooling.png' height='350'&gt;&lt;/img&gt;
]

`\(\large max(1,1,5,6)=6\)`

---
# Model output

.center[
  &lt;img src='images/emphnet2.png' height='350'&gt;&lt;/img&gt;
]


---
# Model training

.center[
  &lt;img src='images/training.png' height='500'&gt;&lt;/img&gt;
 ]
 
---
# Loss function

Cross entropy
`$$\huge H(p,q)=-\sum_{x\in {\mathcal {X}}}p(x)\,\log q(x)$$`
---
# Physician-annotation versus emphysema probability

```
lmtest::lrtest(neg_t0, neg_emph_t0, neg_pemph_t0)
```

```
Model 1: case ~ log1yrisk - 1
Model 2: case ~ log1yrisk + log1yrisk:emphysema - 1
Model 3: case ~ log1yrisk + log1yrisk:p_emph - 1
Model 4: case ~ log1yrisk + log1yrisk:emphysema + log1yrisk:p_emph - 1

  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   1 -370.74                         
2   2 -367.43  1 6.6249    0.01006 *  
3   2 -367.23  0 0.3978    &lt; 2e-16 ***
4   3 -365.58  1 3.2994    0.06930 .  
```
---

# Future Directions

.center[
  &lt;a href="https://doi.org/10.1093/jnci/djz041"&gt;
    &lt;img src='images/lung_features.jpg' height='450'&gt;&lt;/img&gt;
  &lt;/a&gt;
]

---

# Global smoking deaths are on the rise [(IHME, 2018)](https://ourworldindata.org/grapher/smoking-and-secondhand-deaths)

.center[
  &lt;a href="https://ourworldindata.org/grapher/smoking-and-secondhand-deaths"&gt;
    &lt;img src='images/smoking-and-secondhand-deaths.png' height='500'&gt;&lt;/img&gt;
  &lt;/a&gt;
  ]

---

# Future Directions

- Remove last layer (class) in deep learning model
  - 512 image features instead a single probability 

- Combine LCRAT with geospatial data

---

# Smoking: top modifiable risk factor [(Islami, 2018)]( https://doi.org/10.3322/caac.21440)

.center[
  &lt;figure&gt;
    &lt;a href=" https://doi.org/10.3322/caac.21440"&gt;
      &lt;img src='images/modifiable-risk-factors.png' height='375'&gt;&lt;/img&gt;
    &lt;/a&gt;
    &lt;figcaption&gt;Estimated Proportion and Number of Incident Cancer Cases Attributable to Evaluated Risk Factors in Adults Aged 30 Years and Older in the United States in 2014&lt;/figcaption&gt;
  &lt;/figure&gt;
  ]

---
# Acknowledgements

- DCEG Cancer Screening Group
  - Hormuzd Katki, PhD (preceptor)
  - Wes Caldwell
  - Hilary Robbins, PhD
  - Li Cheung, PhD
  - Christine Berg, MD
  - Anil Chaturvedi, PhD
  - Ronald M. Summers, MD, PhD
  
---
class: center, middle
# Thanks for listening!
---
class: center, middle
# Questions?
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
